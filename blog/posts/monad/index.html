<!DOCTYPE html>
<h1 id="monad">Monad</h1>
<h2 id="secnario">Secnario</h2>
<p>Jimmy has a small blog wher he writes about nature.</p>
<p>Each <code>post</code> in his blog is a simple stirng.</p>
<pre class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">post[</span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">] </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">`# A dae in the life ...`</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">post[</span><span style="color: #79C0FF">2</span><span style="color: #C9D1D9">] </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">`# Once upon a place ...`</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #FF7B72">...</span></span></code></pre>
<p>He has set up a some functions that allow him run with his blog.</p>
<p>One of these functions is <code>spellcheck</code>. It takes <code>post</code> and returns the first mispelled word. If there are no mispelled words, it returns the empty string, <code>""</code>.</p>
<pre class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #D2A8FF">spellcheck</span><span style="color: #C9D1D9">(post[</span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">]); </span><span style="color: #8B949E">// returns `&quot;dae&quot;`</span></span>
<span class="line"><span style="color: #D2A8FF">spellcheck</span><span style="color: #C9D1D9">(post[</span><span style="color: #79C0FF">2</span><span style="color: #C9D1D9">]); </span><span style="color: #8B949E">// returns `&quot;&quot;`</span></span></code></pre>
<p>Another of these functions is <code>border</code>. It takes a <code>post</code> and puts a cool border around it.</p>
<pre class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #D2A8FF">border</span><span style="color: #C9D1D9">(post[</span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">]) </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #A5D6FF">`</span></span>
<span class="line"><span style="color: #A5D6FF">╔════════════  ═════════╗</span></span>
<span class="line"><span style="color: #A5D6FF"> # A dae in the life ...</span></span>
<span class="line"><span style="color: #A5D6FF">╚════════════  ═════════╝`</span><span style="color: #C9D1D9">;</span></span></code></pre>
<p>Jimmy has decided to take on Kate and Leo as co-authors of his blog. Unfortunately, using the current system, the strings lack author information.</p>
<p>Kate thinks they can fix this by creating a new type, <code>authored post</code>, that references a regular post plus an array to represent authors.</p>
<pre class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">type</span><span style="color: #C9D1D9"> </span><span style="color: #FFA657">authoredPost</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FFA657">post</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">string</span><span style="color: #C9D1D9">;</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FFA657">authors</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">string</span><span style="color: #C9D1D9">[];</span></span>
<span class="line"><span style="color: #C9D1D9">};</span></span></code></pre>
<p>Now; when Jimmy, Kate, or Leo create a blog post, they can
be sure to add an author.</p>
<pre class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">newPost</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">  post: </span><span style="color: #A5D6FF">&quot;# Welcome new Co-Authors&quot;</span><span style="color: #C9D1D9">,</span></span>
<span class="line"><span style="color: #C9D1D9">  authors: [</span><span style="color: #A5D6FF">&quot;Jimmy&quot;</span><span style="color: #C9D1D9">],</span></span>
<span class="line"><span style="color: #C9D1D9">};</span></span></code></pre>
<p>What about the post that already exists? Kate has come up with a simple function that “upgrades” a post into an <code>authored post</code>.</p>
<pre class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">upgradePost</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> (</span><span style="color: #FFA657">post</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">string</span><span style="color: #C9D1D9">)</span><span style="color: #FF7B72">:</span><span style="color: #C9D1D9"> </span><span style="color: #FFA657">authoredPost</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">    post,</span></span>
<span class="line"><span style="color: #C9D1D9">    authors: [],</span></span>
<span class="line"><span style="color: #C9D1D9">  };</span></span>
<span class="line"><span style="color: #C9D1D9">};</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FF7B72">for</span><span style="color: #C9D1D9"> (</span><span style="color: #FF7B72">let</span><span style="color: #C9D1D9"> i </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">; i </span><span style="color: #FF7B72">&lt;</span><span style="color: #C9D1D9"> post.</span><span style="color: #79C0FF">length</span><span style="color: #C9D1D9">; i</span><span style="color: #FF7B72">++</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">  post[i] </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">upgradePost</span><span style="color: #C9D1D9">(post[i]);</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span></code></pre>
<p><code>Authored posts</code> have functionality not present in regular posts.
Namey, the ability to have an autor added.</p>
<pre class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">addAuthorJimmy</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> (</span><span style="color: #FFA657">post</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> ({</span></span>
<span class="line"><span style="color: #C9D1D9">  post,</span></span>
<span class="line"><span style="color: #C9D1D9">  authors: [</span><span style="color: #FF7B72">...</span><span style="color: #C9D1D9">authors, </span><span style="color: #A5D6FF">&quot;Jimmy&quot;</span><span style="color: #C9D1D9">],</span></span>
<span class="line"><span style="color: #C9D1D9">});</span></span></code></pre>
<pre class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">blog[</span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">] </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">addAuthorJimmy</span><span style="color: #C9D1D9">(blog[</span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">]);</span></span>
<span class="line"><span style="color: #C9D1D9">blog[</span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">] </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">addAuthorJimmy</span><span style="color: #C9D1D9">(blog[</span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">]);</span></span></code></pre>
<p>Remember that Jimmy’s blog has a number of functions to manage it, including <code>spellcheck</code> and <code>border</code>?</p>
<p>Jimmy worries that he’ll have to re-write all of these functions. This time, Leo has an idea.</p>
<p>Rather than individually constructing a special “authored” editon of each function (<code>spellcheckAuthored</code>, <code>borderAuthored</code>, etc.), he wants to create a single new function that takes a <em>transformation</em> between <code>posts</code> and converts it into a transformation between <code>authored posts</code>.</p>
<p>new function that takes an <code>authored post</code> and returns a new <code>authored post</code>.</p>
<pre class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">convertAuthored</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> (</span><span style="color: #FFA657">postFunc</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">  (</span><span style="color: #FFA657">authoredPost</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> { </span><span style="color: #79C0FF">post</span><span style="color: #C9D1D9"> } </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> authoredPost;</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">upgrade</span><span style="color: #C9D1D9">(</span><span style="color: #D2A8FF">postFunc</span><span style="color: #C9D1D9">(post));</span></span>
<span class="line"><span style="color: #C9D1D9">  };</span></span>
<span class="line"><span style="color: #C9D1D9">};</span></span>
<span class="line"><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">spellcheckAuthored</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">convertAuthored</span><span style="color: #C9D1D9">(spellcheck);</span></span></code></pre>
<p>Now, Jimmy can use <code>spellcheckAuthored</code> to check the spelling of new blogposts.</p>
<h2 id="what-is-a-monad">What is a monad?</h2>
<p>The scenario above is an example of a monad.</p>
<p>A monad is a way to give additional functioality to a group of things, while preserving functionality of the original group.</p>
<p>We construct a monad by:</p>
<ul>
<li>
<p>first defining a type (call it <strong>a</strong>) that represents our original group of things. This was the <code>post</code> in the example above.</p>
</li>
<li>
<p>We then define a type (calle it <strong>Ma</strong>) that represents a new group,
where these members are like those of “a”, but wrapped with additional functionality. This was <code>authored post</code> in the example above.</p>
</li>
<li>
<p>We then define a way (call this <strong>unit</strong>) to transform a member of <strong>a</strong> into a member of <strong>Ma</strong>. This was the <code>upgrade</code> function in the example above.</p>
</li>
<li>
<p>Finally, we define a way (call this <strong>bind</strong>) to convert any function that maps a member of <strong>a</strong> to <strong>a</strong> into a function that maps <strong>Ma</strong> to <strong>Ma</strong>. This was the <code>convert</code> function in the example above.</p>
</li>
</ul>
<p>Having defined all <strong>a</strong>, <strong>Ma</strong>, <strong>unit</strong>, and <strong>bind</strong>, we see that the secnario above formally represents a monad.</p>
<h2 id="monad-factory">Monad Factory</h2>
<p>We can create generic monads to better study them.</p>
<p>We’ll simplify things by chosing <strong>a</strong> to be the set of numbers (representable in Javascript).</p>
<p>As a mapping function between <strong>a</strong> and <strong>a</strong> , we choose:</p>
<pre class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #8B949E">// type a = Numbers</span></span>
<span class="line"><span style="color: #8B949E">// f: a → a</span></span>
<span class="line"><span style="color: #8B949E">// f: x ↦ x+1</span></span>
<span class="line"><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">f</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> (</span><span style="color: #FFA657">x</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> x </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">;</span></span></code></pre>
<p>Although <strong>a</strong>, <strong>Ma</strong> are necessary to represent a monad, they are usually implied by <strong>unit</strong> and <strong>bind</strong>.</p>
<p>As such, all we need to define a mondad as an object is to create an object with methods represeting <strong>unit</strong> and <strong>bind</strong>.</p>
<p>Below we creat a function that when passed a unit and a bind function,
returns and object with them attached as methods.</p>
<pre class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">makeMonad</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> (</span><span style="color: #FFA657">unit</span><span style="color: #C9D1D9">, </span><span style="color: #FFA657">bind</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> ({</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #D2A8FF">unit</span><span style="color: #C9D1D9">(</span><span style="color: #FF7B72">...</span><span style="color: #FFA657">args</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">unit</span><span style="color: #C9D1D9">(</span><span style="color: #FF7B72">...</span><span style="color: #C9D1D9">args);</span></span>
<span class="line"><span style="color: #C9D1D9">  },</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #D2A8FF">bind</span><span style="color: #C9D1D9">(</span><span style="color: #FF7B72">...</span><span style="color: #FFA657">args</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">bind</span><span style="color: #C9D1D9">(</span><span style="color: #FF7B72">...</span><span style="color: #C9D1D9">args);</span></span>
<span class="line"><span style="color: #C9D1D9">  },</span></span>
<span class="line"><span style="color: #C9D1D9">});</span></span></code></pre>
<h3 id="identity-monad">Identity Monad</h3>
<p>We can pass the identity function as both unit and the bind into makeMonad to create the identity monad.</p>
<pre class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">identityMonad</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">makeMonad</span><span style="color: #C9D1D9">(</span></span>
<span class="line"><span style="color: #C9D1D9">  (</span><span style="color: #FFA657">x</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> x,</span></span>
<span class="line"><span style="color: #C9D1D9">  (</span><span style="color: #FFA657">x</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> x</span></span>
<span class="line"><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">one</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> monad.</span><span style="color: #D2A8FF">unit</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #8B949E">// plusOne : a ↦ a + 1</span></span>
<span class="line"><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">plusOne</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> monad.</span><span style="color: #D2A8FF">bind</span><span style="color: #C9D1D9">(f);</span></span>
<span class="line"><span style="color: #C9D1D9">console.</span><span style="color: #D2A8FF">log</span><span style="color: #C9D1D9">(</span><span style="color: #D2A8FF">plusOne</span><span style="color: #C9D1D9">(one)); </span><span style="color: #8B949E">// 2</span></span></code></pre>
<p>Note that no addional functionaly is provided by the identity monad.</p>
<h3 id="list-monad">List Monad</h3>
<pre class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">monad</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">makeMonad</span><span style="color: #C9D1D9">(</span></span>
<span class="line"><span style="color: #C9D1D9">  (</span><span style="color: #FFA657">x</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> [x],</span></span>
<span class="line"><span style="color: #C9D1D9">  (</span><span style="color: #FFA657">f</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> (</span><span style="color: #FFA657">x</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> [</span><span style="color: #D2A8FF">f</span><span style="color: #C9D1D9">(x[</span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">])]</span></span>
<span class="line"><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">one</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> monad.</span><span style="color: #D2A8FF">unit</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #8B949E">// plusOne : [a] ↦ [a + 1]</span></span>
<span class="line"><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">plusOne</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> monad.</span><span style="color: #D2A8FF">bind</span><span style="color: #C9D1D9">(f);</span></span>
<span class="line"><span style="color: #C9D1D9">console.</span><span style="color: #D2A8FF">log</span><span style="color: #C9D1D9">(</span><span style="color: #D2A8FF">plusOne</span><span style="color: #C9D1D9">(one)); </span><span style="color: #8B949E">// [2]</span></span></code></pre>
<p>Additional functions for working with list exist as part of the definition of the List type.</p>
<pre class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">ListMethods</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #D2A8FF">concat</span><span style="color: #C9D1D9">(</span><span style="color: #FFA657">x</span><span style="color: #C9D1D9">, </span><span style="color: #FFA657">y</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> [</span><span style="color: #FF7B72">...</span><span style="color: #C9D1D9">x, </span><span style="color: #FF7B72">...</span><span style="color: #C9D1D9">y];</span></span>
<span class="line"><span style="color: #C9D1D9">  },</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #D2A8FF">intersect</span><span style="color: #C9D1D9">(</span><span style="color: #FFA657">x</span><span style="color: #C9D1D9">, </span><span style="color: #FFA657">y</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> x.</span><span style="color: #D2A8FF">filter</span><span style="color: #C9D1D9">((</span><span style="color: #FFA657">x</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> y.</span><span style="color: #D2A8FF">includes</span><span style="color: #C9D1D9">(x));</span></span>
<span class="line"><span style="color: #C9D1D9">  },</span></span>
<span class="line"><span style="color: #C9D1D9">};</span></span>
<span class="line"><span style="color: #C9D1D9">console.</span><span style="color: #D2A8FF">log</span><span style="color: #C9D1D9">(ListMethods.</span><span style="color: #D2A8FF">concat</span><span style="color: #C9D1D9">(array.</span><span style="color: #D2A8FF">unit</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">4</span><span style="color: #C9D1D9">), altArray.</span><span style="color: #D2A8FF">atom</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">5</span><span style="color: #C9D1D9">)));</span></span>
<span class="line"><span style="color: #C9D1D9">console.</span><span style="color: #D2A8FF">log</span><span style="color: #C9D1D9">(ListMethods.</span><span style="color: #D2A8FF">intersect</span><span style="color: #C9D1D9">(array.</span><span style="color: #D2A8FF">unit</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">4</span><span style="color: #C9D1D9">), altArray.</span><span style="color: #D2A8FF">unit</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">5</span><span style="color: #C9D1D9">)));</span></span>
<span class="line"><span style="color: #C9D1D9">console.</span><span style="color: #D2A8FF">log</span><span style="color: #C9D1D9">(</span></span>
<span class="line"><span style="color: #C9D1D9">  ListMethods.</span><span style="color: #D2A8FF">intersect</span><span style="color: #C9D1D9">(</span></span>
<span class="line"><span style="color: #C9D1D9">    ListMethods.</span><span style="color: #D2A8FF">concat</span><span style="color: #C9D1D9">(monad.</span><span style="color: #D2A8FF">unit</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">4</span><span style="color: #C9D1D9">), monad.</span><span style="color: #D2A8FF">unit</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">5</span><span style="color: #C9D1D9">)),</span></span>
<span class="line"><span style="color: #C9D1D9">    ListMethods.</span><span style="color: #D2A8FF">concat</span><span style="color: #C9D1D9">(monad.</span><span style="color: #D2A8FF">unit</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">5</span><span style="color: #C9D1D9">), monad.</span><span style="color: #D2A8FF">unit</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">6</span><span style="color: #C9D1D9">))</span></span>
<span class="line"><span style="color: #C9D1D9">  )</span></span>
<span class="line"><span style="color: #C9D1D9">);</span></span></code></pre>
<h3 id="log-monad">Log Monad</h3>
<pre class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">monad</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">makeMonad</span><span style="color: #C9D1D9">(</span></span>
<span class="line"><span style="color: #C9D1D9">  (</span><span style="color: #FFA657">x</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> ({ value: x, logs: [] }),</span></span>
<span class="line"><span style="color: #C9D1D9">  (</span><span style="color: #FFA657">f</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> (</span><span style="color: #FFA657">x</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> ({ value: </span><span style="color: #D2A8FF">f</span><span style="color: #C9D1D9">(x.value), logs: x.logs })</span></span>
<span class="line"><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">one</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> monad.</span><span style="color: #D2A8FF">unit</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #8B949E">// plusOne : {value:a, logs:[]} ↦ {value:a+1, logs:[]}</span></span>
<span class="line"><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">plusOne</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> monad.</span><span style="color: #D2A8FF">bind</span><span style="color: #C9D1D9">(f);</span></span>
<span class="line"><span style="color: #C9D1D9">console.</span><span style="color: #D2A8FF">log</span><span style="color: #C9D1D9">(</span><span style="color: #D2A8FF">plusOne</span><span style="color: #C9D1D9">(one)); </span><span style="color: #8B949E">// {value:2, logs:[]}</span></span></code></pre>
<p>Additional functions for working with logs exist as part of the definition of the Log type.</p>
<pre class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">LogMethods</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #D2A8FF">add</span><span style="color: #C9D1D9">(</span><span style="color: #FF7B72">...</span><span style="color: #FFA657">args</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">    value: args.</span><span style="color: #D2A8FF">reduce</span><span style="color: #C9D1D9">((</span><span style="color: #FFA657">p</span><span style="color: #C9D1D9">, </span><span style="color: #FFA657">c</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> p </span><span style="color: #FF7B72">+</span><span style="color: #C9D1D9"> c.value, </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">),</span></span>
<span class="line"><span style="color: #C9D1D9">    logs: [</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">...</span><span style="color: #C9D1D9">args</span></span>
<span class="line"><span style="color: #C9D1D9">    .</span><span style="color: #D2A8FF">map</span><span style="color: #C9D1D9">((</span><span style="color: #FFA657">x</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> x.logs)</span></span>
<span class="line"><span style="color: #C9D1D9">    .</span><span style="color: #D2A8FF">flat</span><span style="color: #C9D1D9">()</span></span>
<span class="line"><span style="color: #C9D1D9">    .</span><span style="color: #D2A8FF">reverse</span><span style="color: #C9D1D9">(),</span></span>
<span class="line"><span style="color: #C9D1D9">    args.</span><span style="color: #D2A8FF">map</span><span style="color: #C9D1D9">((</span><span style="color: #FFA657">x</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> x.value).</span><span style="color: #D2A8FF">join</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">&quot; added to &quot;</span><span style="color: #C9D1D9">),</span></span>
<span class="line"><span style="color: #C9D1D9">    ],</span></span>
<span class="line"><span style="color: #C9D1D9">    };</span></span>
<span class="line"><span style="color: #C9D1D9">  },</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #D2A8FF">multiply</span><span style="color: #C9D1D9">(</span><span style="color: #FF7B72">...</span><span style="color: #FFA657">args</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">    value: args.</span><span style="color: #D2A8FF">reduce</span><span style="color: #C9D1D9">((</span><span style="color: #FFA657">p</span><span style="color: #C9D1D9">, </span><span style="color: #FFA657">c</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> p \</span><span style="color: #FF7B72">*</span><span style="color: #C9D1D9"> c.value, </span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">),</span></span>
<span class="line"><span style="color: #C9D1D9">    logs: [</span><span style="color: #FF7B72">...</span><span style="color: #C9D1D9">args.</span><span style="color: #D2A8FF">map</span><span style="color: #C9D1D9">((</span><span style="color: #FFA657">x</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> x.logs).</span><span style="color: #D2A8FF">reverse</span><span style="color: #C9D1D9">().</span><span style="color: #D2A8FF">flat</span><span style="color: #C9D1D9">(),</span></span>
<span class="line"><span style="color: #C9D1D9">      args.</span><span style="color: #D2A8FF">map</span><span style="color: #C9D1D9">((</span><span style="color: #FFA657">x</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> x.value).</span><span style="color: #D2A8FF">join</span><span style="color: #C9D1D9">(</span><span style="color: #A5D6FF">&quot; multiplied by &quot;</span><span style="color: #C9D1D9">),],</span></span>
<span class="line"><span style="color: #C9D1D9">    };</span></span>
<span class="line"><span style="color: #C9D1D9">  },</span></span>
<span class="line"><span style="color: #C9D1D9">};</span></span>
<span class="line"><span style="color: #C9D1D9">console.</span><span style="color: #D2A8FF">log</span><span style="color: #C9D1D9">(LogMethods.</span><span style="color: #D2A8FF">add</span><span style="color: #C9D1D9">(monad.</span><span style="color: #D2A8FF">unit</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">4</span><span style="color: #C9D1D9">), monad.</span><span style="color: #D2A8FF">unit</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">5</span><span style="color: #C9D1D9">)));</span></span>
<span class="line"><span style="color: #C9D1D9">console.</span><span style="color: #D2A8FF">log</span><span style="color: #C9D1D9">(LogMethods.</span><span style="color: #D2A8FF">multiply</span><span style="color: #C9D1D9">(monad.</span><span style="color: #D2A8FF">unit</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">4</span><span style="color: #C9D1D9">), monad.</span><span style="color: #D2A8FF">unit</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">5</span><span style="color: #C9D1D9">)));</span></span>
<span class="line"><span style="color: #C9D1D9">console.</span><span style="color: #D2A8FF">log</span><span style="color: #C9D1D9">(LogMethods.</span><span style="color: #D2A8FF">multiply</span><span style="color: #C9D1D9">(</span></span>
<span class="line"><span style="color: #C9D1D9">  LogMethods.</span><span style="color: #D2A8FF">add</span><span style="color: #C9D1D9">(monad.</span><span style="color: #D2A8FF">unit</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">3</span><span style="color: #C9D1D9">), monad.</span><span style="color: #D2A8FF">unit</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">5</span><span style="color: #C9D1D9">)),</span></span>
<span class="line"><span style="color: #C9D1D9">  monad.</span><span style="color: #D2A8FF">unit</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">4</span><span style="color: #C9D1D9">)</span></span>
<span class="line"><span style="color: #C9D1D9">)</span></span>
<span class="line"><span style="color: #C9D1D9">);</span></span></code></pre>
<h3 id="maybe-monad">Maybe Monad</h3>
<pre class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">monad</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">makeMonad</span><span style="color: #C9D1D9">(</span></span>
<span class="line"><span style="color: #C9D1D9">  (</span><span style="color: #FFA657">x</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> ({ value: x, null: </span><span style="color: #79C0FF">false</span><span style="color: #C9D1D9"> }),</span></span>
<span class="line"><span style="color: #C9D1D9">  (</span><span style="color: #FFA657">f</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> (</span><span style="color: #FFA657">x</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> ({ value: </span><span style="color: #D2A8FF">f</span><span style="color: #C9D1D9">(x.value), null: </span><span style="color: #79C0FF">false</span><span style="color: #C9D1D9"> })</span></span>
<span class="line"><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">one</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> monad.</span><span style="color: #D2A8FF">unit</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #8B949E">// plusOne : {value:a, null:false} ↦ {value:a+1, null:true}</span></span>
<span class="line"><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">plusOne</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> monad.</span><span style="color: #D2A8FF">bind</span><span style="color: #C9D1D9">(f);</span></span>
<span class="line"><span style="color: #C9D1D9">console.</span><span style="color: #D2A8FF">log</span><span style="color: #C9D1D9">(</span><span style="color: #D2A8FF">plusOne</span><span style="color: #C9D1D9">(one)); </span><span style="color: #8B949E">// {value:2, null:false}</span></span></code></pre>
<pre class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">MaybeMethods</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #D2A8FF">divide</span><span style="color: #C9D1D9">(</span><span style="color: #FFA657">x</span><span style="color: #C9D1D9">, </span><span style="color: #FFA657">y</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (x.null </span><span style="color: #FF7B72">||</span><span style="color: #C9D1D9"> y.null) {</span></span>
<span class="line"><span style="color: #C9D1D9">      </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> { null: </span><span style="color: #79C0FF">true</span><span style="color: #C9D1D9"> };</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (y.value </span><span style="color: #FF7B72">===</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">      </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> { null: </span><span style="color: #79C0FF">true</span><span style="color: #C9D1D9"> };</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> { value: x.value </span><span style="color: #FF7B72">/</span><span style="color: #C9D1D9"> y.value, null: </span><span style="color: #79C0FF">false</span><span style="color: #C9D1D9"> };</span></span>
<span class="line"><span style="color: #C9D1D9">  },</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #D2A8FF">subtract</span><span style="color: #C9D1D9">(</span><span style="color: #FFA657">x</span><span style="color: #C9D1D9">, </span><span style="color: #FFA657">y</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> (x.null </span><span style="color: #FF7B72">||</span><span style="color: #C9D1D9"> y.null) {</span></span>
<span class="line"><span style="color: #C9D1D9">      </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> { null: </span><span style="color: #79C0FF">true</span><span style="color: #C9D1D9"> };</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> { value: x.value </span><span style="color: #FF7B72">-</span><span style="color: #C9D1D9"> y.value, null: </span><span style="color: #79C0FF">false</span><span style="color: #C9D1D9"> };</span></span>
<span class="line"><span style="color: #C9D1D9">  },</span></span>
<span class="line"><span style="color: #C9D1D9">};</span></span>
<span class="line"><span style="color: #C9D1D9">console.</span><span style="color: #D2A8FF">log</span><span style="color: #C9D1D9">(MaybeMethods.</span><span style="color: #D2A8FF">divide</span><span style="color: #C9D1D9">(monad.</span><span style="color: #D2A8FF">unit</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">4</span><span style="color: #C9D1D9">), monad.</span><span style="color: #D2A8FF">unit</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">2</span><span style="color: #C9D1D9">)));</span></span>
<span class="line"><span style="color: #C9D1D9">console.</span><span style="color: #D2A8FF">log</span><span style="color: #C9D1D9">(MaybeMethods.</span><span style="color: #D2A8FF">subtract</span><span style="color: #C9D1D9">(monad.</span><span style="color: #D2A8FF">unit</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">4</span><span style="color: #C9D1D9">), monad.</span><span style="color: #D2A8FF">unit</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">)));</span></span>
<span class="line"><span style="color: #C9D1D9">console.</span><span style="color: #D2A8FF">log</span><span style="color: #C9D1D9">(</span></span>
<span class="line"><span style="color: #C9D1D9">  MaybeMethods.</span><span style="color: #D2A8FF">divide</span><span style="color: #C9D1D9">(</span></span>
<span class="line"><span style="color: #C9D1D9">    monad.</span><span style="color: #D2A8FF">unit</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">4</span><span style="color: #C9D1D9">),</span></span>
<span class="line"><span style="color: #C9D1D9">    MaybeMethods.</span><span style="color: #D2A8FF">subtract</span><span style="color: #C9D1D9">(monad.</span><span style="color: #D2A8FF">unit</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">2</span><span style="color: #C9D1D9">), monad.</span><span style="color: #D2A8FF">unit</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">2</span><span style="color: #C9D1D9">))</span></span>
<span class="line"><span style="color: #C9D1D9">  )</span></span>
<span class="line"><span style="color: #C9D1D9">);</span></span></code></pre>
<h2 id="inveresion">Inveresion</h2>
<p>Monads may have a strict formal definition,
but their usage is such that their.</p>
<p>This is similar to the previous ‘makeMonad’ function — we use a similar ‘unit’ function, but replace the ‘bind’ function with a function called ‘deunit’ that takes a value from <strong>Ma</strong> and converts into a value from <strong>a</strong>.</p>
<pre class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">createMonad</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> (</span><span style="color: #D2A8FF">unit</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> (</span><span style="color: #FFA657">x</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> x, </span><span style="color: #D2A8FF">deunit</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> (</span><span style="color: #FFA657">x</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> x) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> ({</span></span>
<span class="line"><span style="color: #C9D1D9">  promote,</span></span>
<span class="line"><span style="color: #C9D1D9">  deunit,</span></span>
<span class="line"><span style="color: #C9D1D9">});</span></span></code></pre>
<p>We then create function, bindToMonad that takes our monad object, and creates <strong>bind</strong> from it.</p>
<pre class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">bindFromMonad</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> (</span><span style="color: #FFA657">monad</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> (</span><span style="color: #FFA657">func</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> (</span><span style="color: #FFA657">arg</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> {</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">promote</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> monad?.promote </span><span style="color: #FF7B72">||</span><span style="color: #C9D1D9"> ((</span><span style="color: #FFA657">x</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> x);</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">demote</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> monad?.demote </span><span style="color: #FF7B72">||</span><span style="color: #C9D1D9"> ((</span><span style="color: #FFA657">x</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> x);</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">promote</span><span style="color: #C9D1D9">(</span><span style="color: #D2A8FF">func</span><span style="color: #C9D1D9">(</span><span style="color: #D2A8FF">demote</span><span style="color: #C9D1D9">(arg)));</span></span>
<span class="line"><span style="color: #C9D1D9">};</span></span></code></pre>
<p>Using these functions together,
we create a slightly more complicated monad factory.</p>
<pre class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">identity</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">createMonad</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">bindToIdentity</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">bindFromMonad</span><span style="color: #C9D1D9">(identity);</span></span>
<span class="line"><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">one</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> identity.</span><span style="color: #D2A8FF">unit</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">plusOne</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">bindToIdentity</span><span style="color: #C9D1D9">(f);</span></span>
<span class="line"><span style="color: #C9D1D9">console.</span><span style="color: #D2A8FF">log</span><span style="color: #C9D1D9">(</span><span style="color: #D2A8FF">plusOne</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">)); </span><span style="color: #8B949E">// 2</span></span></code></pre>
<p>We can modify the “bindFromMonad” function to use a function’s context object (this) rather than an explicitly passed one.</p>
<pre class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">monadBindable</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> (</span><span style="color: #FFA657">func</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">function</span><span style="color: #C9D1D9"> (</span><span style="color: #FF7B72">...</span><span style="color: #FFA657">args</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">promote</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">this</span><span style="color: #C9D1D9">?.promote </span><span style="color: #FF7B72">||</span><span style="color: #C9D1D9"> ((</span><span style="color: #FFA657">x</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> x);</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">demote</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">this</span><span style="color: #C9D1D9">?.demote </span><span style="color: #FF7B72">||</span><span style="color: #C9D1D9"> ((</span><span style="color: #FFA657">x</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> x);</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #8B949E">// return promote(func(demote(...args)));</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #FF7B72">return</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">promote</span><span style="color: #C9D1D9">(</span><span style="color: #FF7B72">...</span><span style="color: #C9D1D9">args.</span><span style="color: #D2A8FF">map</span><span style="color: #C9D1D9">(demote).</span><span style="color: #D2A8FF">map</span><span style="color: #C9D1D9">(func));</span></span>
<span class="line"><span style="color: #C9D1D9">  };</span></span></code></pre>
<p>This creates a function that is generically “bindable” monads created in the way described above.</p>
<pre class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">F</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">monadBindable</span><span style="color: #C9D1D9">(f);</span></span>
<span class="line"><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">identity</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">createMonad</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">plusOne</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">F</span><span style="color: #C9D1D9">.</span><span style="color: #D2A8FF">bind</span><span style="color: #C9D1D9">(identity);</span></span>
<span class="line"><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">one</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> identity.</span><span style="color: #D2A8FF">unit</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">console.</span><span style="color: #D2A8FF">log</span><span style="color: #C9D1D9">(</span><span style="color: #D2A8FF">plusOne</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">)); </span><span style="color: #8B949E">// 2</span></span></code></pre>
<p>This methods works for other monads as well,
but ensure that you use a “deunit” in place of a “bind” function.</p>
<h3 id="list-monad-1">List Monad</h3>
<pre class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">list</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">createMonad</span><span style="color: #C9D1D9">(</span></span>
<span class="line"><span style="color: #C9D1D9">  (</span><span style="color: #FFA657">x</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> [x],</span></span>
<span class="line"><span style="color: #C9D1D9">  (</span><span style="color: #FFA657">x</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> x[</span><span style="color: #79C0FF">0</span><span style="color: #C9D1D9">]</span></span>
<span class="line"><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">plusOne</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">F</span><span style="color: #C9D1D9">.</span><span style="color: #D2A8FF">bind</span><span style="color: #C9D1D9">(list);</span></span>
<span class="line"><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">one</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> list.</span><span style="color: #D2A8FF">unit</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">console.</span><span style="color: #D2A8FF">log</span><span style="color: #C9D1D9">(</span><span style="color: #D2A8FF">plusOne</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">)); </span><span style="color: #8B949E">// 2</span></span></code></pre>
<h3 id="log-monad-1">Log Monad</h3>
<pre class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">log</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">createMonad</span><span style="color: #C9D1D9">(</span></span>
<span class="line"><span style="color: #C9D1D9">  (</span><span style="color: #FFA657">x</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> ({ value: x, logs: [] }),</span></span>
<span class="line"><span style="color: #C9D1D9">  (</span><span style="color: #FFA657">x</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> x.value</span></span>
<span class="line"><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">plusOne</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">F</span><span style="color: #C9D1D9">.</span><span style="color: #D2A8FF">bind</span><span style="color: #C9D1D9">(log);</span></span>
<span class="line"><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">one</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> log.</span><span style="color: #D2A8FF">unit</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">console.</span><span style="color: #D2A8FF">log</span><span style="color: #C9D1D9">(</span><span style="color: #D2A8FF">plusOne</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">)); </span><span style="color: #8B949E">// {value:2, logs:[]}</span></span></code></pre>
<h3 id="maybe-monad-1">Maybe Monad</h3>
<pre class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">maybe</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">createMonad</span><span style="color: #C9D1D9">(</span></span>
<span class="line"><span style="color: #C9D1D9">  (</span><span style="color: #FFA657">x</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> ({ value: x, null: </span><span style="color: #79C0FF">false</span><span style="color: #C9D1D9"> }),</span></span>
<span class="line"><span style="color: #C9D1D9">  (</span><span style="color: #FFA657">x</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> x.value</span></span>
<span class="line"><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">plusOne</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">F</span><span style="color: #C9D1D9">.</span><span style="color: #D2A8FF">bind</span><span style="color: #C9D1D9">(maybe);</span></span>
<span class="line"><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">one</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> maybe.</span><span style="color: #D2A8FF">unit</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #C9D1D9">console.</span><span style="color: #D2A8FF">log</span><span style="color: #C9D1D9">(</span><span style="color: #D2A8FF">plusOne</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">)); </span><span style="color: #8B949E">// {value:2, null:false}</span></span></code></pre>
<pre class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">monad</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">makeMonad</span><span style="color: #C9D1D9">(</span></span>
<span class="line"><span style="color: #C9D1D9">  (</span><span style="color: #FFA657">x</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> ({ value: x, null: </span><span style="color: #79C0FF">false</span><span style="color: #C9D1D9"> }),</span></span>
<span class="line"><span style="color: #C9D1D9">  (</span><span style="color: #FFA657">f</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> (</span><span style="color: #FFA657">x</span><span style="color: #C9D1D9">) </span><span style="color: #FF7B72">=&gt;</span><span style="color: #C9D1D9"> ({ value: </span><span style="color: #D2A8FF">f</span><span style="color: #C9D1D9">(x.value), null: </span><span style="color: #79C0FF">false</span><span style="color: #C9D1D9"> })</span></span>
<span class="line"><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">one</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> monad.</span><span style="color: #D2A8FF">unit</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">1</span><span style="color: #C9D1D9">);</span></span>
<span class="line"><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">plusOne</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> monad.</span><span style="color: #D2A8FF">bind</span><span style="color: #C9D1D9">(f);</span></span>
<span class="line"><span style="color: #C9D1D9">console.</span><span style="color: #D2A8FF">log</span><span style="color: #C9D1D9">(</span><span style="color: #D2A8FF">plusOne</span><span style="color: #C9D1D9">(one)); </span><span style="color: #8B949E">// {value:2, null:false}</span></span></code></pre>