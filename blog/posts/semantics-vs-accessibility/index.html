<!DOCTYPE html><html lang="en"><head><title>John Henry : Blog -- Semantics Versus Accessibility</title><link rel="canonical" href="https://johnhenry.github.io/undefined"><meta name="description" content="We explore an issue plaguing modern development and propose a solution"><meta name="robots" content="index,follow"><meta name="theme-color" content="#343233"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta charset="utf-8"><meta name="keywords" content="fun,math,engineering,science,experiments,programming,experimenting"><meta name="author" content="John Henry"><link rel="manifest" href="https://johnhenry.github.io/manifest.json"><link rel="icon" href="https://johnhenry.github.io/image/iajh.png" type="image/png"><link rel="stylesheet" href="https://johnhenry.github.io/lib/vendor/css/reset/2.0.0/index.css"><link rel="stylesheet" href="https://johnhenry.github.io/lib/css/universal-unstyled-links/0.0.0/index.css"><link rel="stylesheet" href="https://johnhenry.github.io/lib/css/universal-box-sizing/0.0.0/index.css"><link rel="stylesheet" href="https://johnhenry.github.io/lib/css/universal-no-margins/0.0.0/index.css"><link rel="stylesheet" href="https://johnhenry.github.io/lib/css/hide-n-show/0.0.0/landscape.css"><link rel="stylesheet" href="https://johnhenry.github.io/style/index.css"><script type="module" src="https://johnhenry.github.io/lib/js/css-variables-mouse/0.0.0/index.mjs"></script><script type="module" src="https://johnhenry.github.io/lib/js/css-variables-scroll/0.0.0/index.mjs"></script><link rel="apple-touch-icon" sizes="512x512" href="https://johnhenry.github.io/image/iajh.512.png"><link rel="apple-touch-icon" sizes="384x384" href="https://johnhenry.github.io/image/iajh.384.png"><link rel="apple-touch-icon" sizes="256x256" href="https://johnhenry.github.io/image/iajh.256.png"><link rel="apple-touch-icon" sizes="192x192" href="https://johnhenry.github.io/image/iajh.192.png"><link rel="apple-touch-icon" sizes="128x128" href="https://johnhenry.github.io/image/iajh.128.png"><script type="module">
  import localStorageCycler from "https://johnhenry.github.io/lib/js/localstorage-cycler/0.0.0/index.mjs";
  const key = 'color-theme-preference';
  const values = ["color-theme-dark","","color-theme-light"];
  const target = globalThis.document.querySelector("body");
  const emit = ({value, key, index}) => {
    target.classList.remove(...values.filter(s=>s));
    if(value){
      target.classList.add(value);
    }
  }
  window["cycleTheme"] = localStorageCycler(key, emit, ...values);
</script><script type="module">
  import localStorageCycler from "https://johnhenry.github.io/lib/js/localstorage-cycler/0.0.0/index.mjs";
  const key = 'mouse-chaser-preference';
  const values = ["","mouse-chaser-logo","mouse-chaser-coordinates"];
  const target = globalThis.document.querySelector("body");
  const emit = ({value, key, index}) => {
    target.classList.remove(...values.filter(s=>s));
    if(value){
      target.classList.add(value);
    }
  }
  window["cycleMouseChaser"] = localStorageCycler(key, emit, ...values);
</script></head>

<body class="color-theme-dark"><header><a href="/#"><img src="https://johnhenry.github.io/image/iajh.png" width="32" height="32" alt="logo"><p class="hide-n-show-landscape-inline">John Henry Blog -- Semantics Versus Accessibility</p></a><nav class="hide show-landscape-flex"><a href="/blog">Blog</a><a href="/#me">Me</a><a href="/#projects">Projects</a></nav></header><section class="blog-top"><header><p>Semantics Versus Accessibility</p></header><a class="link-untracked" href="/blog">back to blog</a><img width="360" height="210" loading="lazy" src="/vendor/img/www.pexels.com/pixabay/view-of-street-from-a-glass-window.jpg" alt="Astro"><article class="blog-content"><p class="publish-date">4 November 2021</p><h1>Semantics Versus Accessibility</h1><div class="author"><p><a href="#">John Henry</a></p></div><p>Long ago,
while trying to shoehorn
new accessibility standards
into an existing website,
I ran into an interesting problem.</p><p>Kevin Powell’s video on a <a href="https://www.youtube.com/watch?v=NexL5_Vdoq8&amp;ab_channel=KevinPowell">common HTML mistake</a> reminded me of it.</p><h2 id="semantics-for-accessibility">Semantics for Accessibility</h2><p>According to <a href="https://html.spec.whatwg.org/multipage/sections.html#the-h1,-h2,-h3,-h4,-h5,-and-h6-elements">current standards</a>
HTML heading elements must appear
in a hierarchy within a web page.</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>The first Thanksgiving<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>section</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span>Leaving England<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>
      Due to certain "differences", the pilgrims decided to leave england...
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>section</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span>Getting on the boat<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>The Mayflower was a mighty ship...<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>section</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>section</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>section</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span>Crossing the sea<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>...<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>section</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
</code></pre><p>This allows screen readers
to recognize content and
describe it to the user of a website.</p><h2 id="the-problem">The Problem</h2><p>Modern component-based design would have us
create components that are unaware of their containers.</p><p>Semantically, a top level heading within a component shouldn’t depend upon the headings of its ancestors.</p><p>You would be tempted do this:</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>The first Thanksgiving<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>section</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>Leaving England<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>
      Due to certain "differences", the pilgrims decided to leave england...
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>section</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>Getting on the boat<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>The Mayflower was a mighty ship...<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>section</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>section</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>section</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>Crossing the sea<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>...<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>section</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
</code></pre><p>isolating the semantics of the sections heading.</p><p>In fact, there was a proposal
to allow this —
the “Document Outline Algorithm”.
Sadly, it was <a href="https://adrianroselli.com/2016/08/there-is-no-document-outline-algorithm.html">never implemented</a>.</p><p>But, in the case of HTML headings; if a section has a heading of “h2”,
it must be the child of a section with an “h1”.
A section with an “h3”
must have a parent with and “h2” and so on.</p><p>The problem arises in that <em>using sensical <strong>semantics</strong> to create components is at odds with how screenreaders interpret <strong>accessibility</strong> cues in HTML</em>… or…</p><p><strong>Semantics Versus Accessibility</strong>.</p><p>(That’s the name of the <del>movie</del> post!)</p><h2 id="the-solution">The Solution</h2><p>We can mitigate this by passing
a bit of context to components to
indicate hierarchical positioning.</p><p>We will do this using <a href="https://astro.build">Astro</a>,
though the concept should be translatable
to other environments.</p><pre class=" language-astro"><code class="language-astro"><span class="token operator">--</span><span class="token operator">-</span>
<span class="token comment">// file:///./boring-section.astro</span>
<span class="token keyword">const</span> parentLevel <span class="token operator">=</span> Astro<span class="token punctuation">.</span>props<span class="token punctuation">.</span>paerentLevel <span class="token operator">||</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> currentLevel <span class="token operator">=</span> Astro<span class="token punctuation">.</span>props<span class="token punctuation">.</span>currentLevel <span class="token operator">=</span> parentLevel <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token operator">--</span><span class="token operator">-</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
<span class="token selector">section</span> <span class="token punctuation">{</span>
  <span class="token property">color</span><span class="token punctuation">:</span> black<span class="token punctuation">;</span>
  <span class="token property">font-style</span><span class="token punctuation">:</span> normal<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>section</span><span class="token punctuation">&gt;</span></span>
  <span class="token operator">&lt;</span>h<span class="token punctuation">{</span>currentLevel<span class="token punctuation">}</span><span class="token operator">&gt;</span>Boring Section<span class="token operator">&lt;</span><span class="token operator">/</span>h<span class="token punctuation">{</span>currentLevel<span class="token punctuation">}</span><span class="token operator">&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>section</span><span class="token punctuation">&gt;</span></span>
</code></pre><pre class=" language-astro"><code class="language-astro"><span class="token operator">--</span><span class="token operator">-</span>
<span class="token comment">// file:///./fancy-section.astro</span>
<span class="token keyword">const</span> parentLevel <span class="token operator">=</span> Astro<span class="token punctuation">.</span>props<span class="token punctuation">.</span>paerentLevel <span class="token operator">||</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> currentLevel <span class="token operator">=</span> Astro<span class="token punctuation">.</span>props<span class="token punctuation">.</span>currentLevel <span class="token operator">=</span> parentLevel <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token operator">--</span><span class="token operator">-</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
  <span class="token selector">section</span> <span class="token punctuation">{</span>
    <span class="token property">color</span><span class="token punctuation">:</span> pink<span class="token punctuation">;</span>
    <span class="token property">font-style</span><span class="token punctuation">:</span> italic<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>section</span><span class="token punctuation">&gt;</span></span>
  <span class="token operator">&lt;</span>h<span class="token punctuation">{</span>currentLevel<span class="token punctuation">}</span><span class="token operator">&gt;</span>Fancy Section<span class="token operator">&lt;</span><span class="token operator">/</span>h<span class="token punctuation">{</span>currentLevel<span class="token punctuation">}</span><span class="token operator">&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>section</span><span class="token punctuation">&gt;</span></span>
</code></pre><pre class=" language-astro"><code class="language-astro"><span class="token operator">--</span><span class="token operator">-</span>
<span class="token keyword">import</span> BoringSection <span class="token keyword">from</span> <span class="token string">"./boring-section.astro"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> FancySection <span class="token keyword">from</span> <span class="token string">"./fancy-section.astro"</span><span class="token punctuation">;</span>
<span class="token operator">--</span><span class="token operator">-</span>
<span class="token operator">--</span><span class="token operator">-</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">BoringSection</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">FancySection</span></span> <span class="token attr-name">parentLevel</span><span class="token script language-typescript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      Hello, Earl!
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">FancySection</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">BoringSection</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
</code></pre><p>This will produce the following HTML:</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>section</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>Fancy Section<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>section</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span>Boring Section<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>Hello, Earl!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>section</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>section</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
</code></pre><p>You can use a utility function
to make the code a bit cleaner a bit cleaner.</p><pre class=" language-javascript"><code class="language-javascript"><span class="token comment">// file:///./get-level.mjs</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">(</span><span class="token parameter">Astro</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>Astro<span class="token punctuation">.</span>props<span class="token punctuation">.</span>parentLevel <span class="token operator">||</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre><pre class=" language-astro"><code class="language-astro"><span class="token operator">--</span><span class="token operator">-</span>
<span class="token comment">// file:///./boring-section.astro</span>
<span class="token keyword">import</span> getLevel <span class="token keyword">from</span> <span class="token string">"./get-level.mjs"</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> currentLevel <span class="token operator">=</span> <span class="token function">getLevel</span><span class="token punctuation">(</span>Astro<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">--</span><span class="token operator">-</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
<span class="token selector">section</span> <span class="token punctuation">{</span>
  <span class="token property">color</span><span class="token punctuation">:</span> black<span class="token punctuation">;</span>
  <span class="token property">font-style</span><span class="token punctuation">:</span> normal<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>section</span><span class="token punctuation">&gt;</span></span>
  <span class="token operator">&lt;</span>h<span class="token punctuation">{</span>currentLevel<span class="token punctuation">}</span><span class="token operator">&gt;</span>Boring Section<span class="token operator">&lt;</span><span class="token operator">/</span>h<span class="token punctuation">{</span>currentLevel<span class="token punctuation">}</span><span class="token operator">&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>section</span><span class="token punctuation">&gt;</span></span>
</code></pre><p>Still, this is not ideal
as the developer is required
to manually pass the parentLevel property
through to each child.</p><p>Using nested, indexed for loops may help,
but I can already imagine being convoluted.</p><p>The <a href="https://reactjs.org/docs/context.html">React Context API</a> and the
<a href="https://v3.vuejs.org/guide/component-provide-inject.htm">Vue Provide/Inject API</a>
may also provide solutions.
Hopefully we can explore these in the future.</p></article><a class="link-untracked" href="/blog">back to blog</a></section><span class="mouse-chaser"></span><footer><a href="#">© 2022 John Henry</a><nav><a href="#" class="mouse-chaser-toggler" onclick="event.preventDefault(),window.cycleMouseChaser()" title="Click to toggle mouse."></a><a href="#" class="color-theme-toggler" onclick="event.preventDefault(),window.cycleTheme()" title="Click to toggle color theme."></a></nav></footer></body></html>